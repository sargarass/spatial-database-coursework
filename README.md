# spatial-database-coursework

База данных является in-memory, позволяет создавать таблицы с элементами вида ключ-значение,
в которых ключ состоит из пространственной и временной части.
Пространственная часть — это либо полигон, либо точка, либо ломаная в двумерном пространстве.
Временной частью является либо интервал действительного времени *valid time*, либо время транзакции *transaction time*,
либо и то и другое *bitemporal time*.
Столбцы таблицы могут иметь следующие типы: строка, целое число, действительное число, временная метка.
Также в базе данных обеспечивается уникальность ключа.

Для ускорения пространственных запросов применяется структура данных HLBVH2.
Она представляет собой иерархию ограничивающих оболочек, организованную в двоичное бинарное дерево,
которая строится за линейное число операций.

Возможные операции в базе данных:

1. Поиск *k* ближайших соседей заданной точки среди множества точек.
2. Поиск точек, принадлежащих заданному полигону.
3. Поиск точек, удалённых на расстояние не более *R* от заданной прямой.
4. Вставке множества строк в таблицу.
5. Удаление, выборка и изменение строк в таблице по предикату.

Программа использует CUDA для организации параллелизма на уровне строк базы данных. Т.е. одна операция применяется параллельно к группе строк.
Параллельность на уровне запросов отсутствует.

Более подробное описание в файле texv2.pdf

# Библиотеки и программы, необходимые для сборки
1. cmake 3.0
2. CUDA (nvidia-cuda-toolkit)
3. glew
4. glfw3
5. thrust
6. cub
7. moderngpu
8. openssl

# Сборка (тестировано в linux gentoo)
В файле с проектом:
- cmake CMakeLists.txt
- make

# Запуск
Требуется видеокарта NVIDIA compute capability 2.0.

В папке bin запустить из консоли приложение DataBase.

# Тюнинг кэшей
В файле database.cpp можно поменять размер кэша на видеокарте и ram.
Кэши используются в алгоритмах для быстрой аллокации временной памяти.
```C++
gpudb::GpuStackAllocator::getInstance().resize(1056ULL * 1024ULL * 1024ULL);
StackAllocator::getInstance().resize(1024ULL * 1024ULL * 1024ULL);
```
